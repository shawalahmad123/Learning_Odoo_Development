<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="mp_inherit_wk_seller_product_order_line_search_view" model="ir.ui.view">
            <field name="name">Booking Order Line</field>
            <field name="model">sale.order.line</field>
            <field name="inherit_id" ref="odoo_marketplace.wk_seller_product_order_line_search_view"/>
            <field name="arch" type="xml">

                <xpath expr="//search" position="inside">
                    <filter string="Booking Order" domain="[('product_id.is_booking_type','=',True)]" name="mp_booking_order"/>
                    <filter name="booking_date_today" string="Today's Booking Order" domain="[('booking_date', '=', current_date)]"/>
                </xpath>

            </field>
        </record>


        <record id="mp_booking_inherit_marketplace_base_config_settings_form_view" model="ir.ui.view">
            <field name="name">Marketplace.base.config.setting.mp.booking.inherit</field>
            <field name="model">res.config.settings</field>
            <field name="inherit_id" ref="odoo_marketplace.res_config_settings_view_form"/>
            <field name="arch" type="xml">

               <xpath expr="//div[@id='mp_approval_settings']" position="inside">
                    <div class="col-xs-12 col-md-6 o_setting_box" title="Enable this if you want to approve timeslots automatically.">
                        <div class="o_setting_left_pane">
                            <field name="mp_auto_timeslot_approve" class="oe_inline" help="Enable this if you want to approve timeslots automatically."/>
                        </div>
                        <div class="o_setting_right_pane">
                            <label for="mp_auto_timeslot_approve" string="Booking Timeslot Approval"/>
                            <div class="text-muted">
                                ⇒ If it is enabled then all seller's timeslot will be automatically approved.
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-12 col-md-6 o_setting_box" title="Enable this if you want to approve booking plan automatically.">
                        <div class="o_setting_left_pane">
                            <field name="mp_auto_plan_approve" class="oe_inline" help="Enable this if you want to approve booking plan automatically."/>
                        </div>
                        <div class="o_setting_right_pane">
                            <label for="mp_auto_plan_approve" string="Booking Plan Approval"/>
                            <div class="text-muted">
                                ⇒ If it is enabled then all seller's booking plan will be automatically approved.
                            </div>
                        </div>
                    </div>
                </xpath>


            </field>
        </record>



        <record id="mp_inherit_wk_booking_day_slot_config_Form_view" model="ir.ui.view">
            <field name="name">Mp Inherit Booking Day Slot Config Form</field>
            <field name="model">day.slot.config</field>
            <field name="inherit_id" ref="website_booking_system.wk_booking_day_slot_config_Form_view"/>
            <field name="arch" type="xml">

               <xpath expr="//form//field[@name='booking_slots_ids']//tree//field[@name='time_slot_id']" position="attributes">
                    <attribute name="domain">[('state','in',['approved'])]</attribute>
                    <attribute name="options">{'no_create_edit':True, 'no_open':True, 'no_quick_create':True}</attribute>
                </xpath>
                <xpath expr="//form//field[@name='booking_slots_ids']//tree//field[@name='plan_id']" position="attributes">
                    <attribute name="options">{'no_create_edit':True, 'no_open':True, 'no_quick_create':True}</attribute>
                </xpath>

            </field>
        </record>


        <record id="mp_booking_product_form_view" model="ir.ui.view">
            <field name="name">marketplace.booking.product.form</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="odoo_marketplace.wk_seller_product_template_form_view"/>
            <field name="arch" type="xml">

               <xpath expr="//header" position="inside">
                    <button string="Check Booking Quantity" type="object" name="get_available_bk_qty" attrs="{'invisible':[('is_booking_type','=',False)]}"/>
                </xpath>
                <field name="public_categ_ids" position="after">
                    <div>
                        <field name="is_booking_type"/>
                        <label for="is_booking_type"/>
                    </div>
               </field>
                <xpath expr="//notebook" position="inside">
                    <page name="booking_and_reservation" string="Booking &amp; Reservation" attrs="{'invisible':[('is_booking_type','=',False)]}">
                        <group>
                            <group>
                                <field name="br_start_date" widget="date" options="{&quot;format&quot;: &quot;dd/MM&quot;}" attrs="{'required' : [('is_booking_type','=',True)]}"/>
                            </group>
                            <group>
                                <field name="br_end_date" attrs="{'required' : [('is_booking_type','=',True)]}"/>
                            </group>
                        </group>
                        <group string="Configure Day Slots">
                            <field name="booking_day_slot_ids" nolabel="1"/>
                        </group>
                        <group>
                            <group>
                                <field name="max_bk_qty"/>
                            </group>
                            <group/>
                        </group>
                    </page>
                </xpath>

            </field>
        </record>


        <record id="inherit_mp_booking_product_search_view" model="ir.ui.view">
            <field name="name">marketplace.booking.product.search.inherit</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="odoo_marketplace.wk_product_template_seller_filter"/>
            <field name="arch" type="xml">

              <xpath expr="//search" position="inside">
                    <filter string="Booking Product" domain="[('is_booking_type','=',True)]" name="mp_booking_product"/>
                </xpath>

            </field>
        </record>

        <record id="inherit_wk_seller_product_template_kanban" model="ir.ui.view">
            <field name="name">mp.bookings.inherit.template.kanban</field>
            <field name="model">marketplace.dashboard</field>
            <field name="inherit_id" ref="odoo_marketplace.wk_seller_product_template_kanban"/>
            <field name="arch" type="xml">

              <!-- Dashboard menu options -->
            <xpath expr="//kanban/templates/t/div/div/div[2]/div/div[3]/div[last()]" position="before">
                <div t-if="record.state.raw_value =='bookings'" class="row">
                    <div class="col-xs-6 o_kanban_card_manage_section o_kanban_manage_view">
                        <div class="o_kanban_card_manage_title">
                            <span style="color:#a24689">View</span>
                        </div>
                        <div>
                            <a name="554" type="action">All</a>
                        </div>
                        <div>
                            <a name="555" type="action">New Order</a>
                        </div>
                        <div>
                            <a name="556" type="action">Approved Order</a>
                        </div>
                        <div>
                            <a name="557" type="action">Shipped Order</a>
                        </div>
                        <div>
                            <a name="558" type="action">Cancelled Order</a>
                        </div>
                    </div>
                    <div class="col-xs-6 o_kanban_card_manage_section o_kanban_manage_new">
                    </div>
                </div>
            </xpath>


            <xpath expr="//kanban/templates/t/div/div/div[2]/div/div/div[4]" position="after">
                <div t-if="record.state.raw_value =='bookings'" style="color:rgb(162, 70, 137)">
                    <center><i class="fa fa-calendar fa-5x"/>
                    <h3>Bookings</h3></center>
                </div>
            </xpath>

            <!-- Dashboard options -->

            <xpath expr="//kanban/templates/t/div/div/div[2]/div/div[2]" position="inside">
                <div t-if="record.state.raw_value =='bookings'">
                    <a class="bg-primary wk_kanban_button_box text-white" name="555" type="action">
                        <span class="o_value"><t t-esc="record.count_product_pending.raw_value"/></span>
                        <span class="o_label">New</span>
                    </a>
                    <a class="wk_kanban_button_box text-white" name="556" type="action" style="background-color:#f0ad4e">
                        <span class="o_value"><t t-esc="record.count_product_approved.raw_value"/></span>
                        <span class="o_label">Approved</span>
                    </a>
                    <a class=" wk_kanban_button_box text-white" name="557" type="action" style="background-color:#5cb85c">
                        <span class="o_value"><t t-esc="record.count_product_rejected.raw_value"/></span>
                        <span class="o_label">Shipped</span>
                    </a>
                </div>
            </xpath>

            </field>
        </record>


         <record id="mp_booking_inherit_wk_seller_product_order_line_form_view" model="ir.ui.view">
            <field name="name">seller.product.sale.order.form.mp.booking.inherit</field>
            <field name="model">sale.order.line</field>
            <field name="inherit_id" ref="odoo_marketplace.wk_seller_product_order_line_form_view"/>
            <field name="arch" type="xml">

             <xpath expr="//label[@for='name']" position="before">
                    <group string="Booking Details" attrs="{'invisible':[('booking_date','=',False)]}">
                        <group>
                            <field name="booking_date" attrs="{'invisible':[('booking_date','=',False)]}"/>
                                <field name="booked_slot_id" options="{'no_open':True,}" attrs="{'invisible':[('booking_date','=',False)]}"/>
                        </group>
                        <group>
                            <field name="booked_plan_id" options="{'no_open':True,}" attrs="{'invisible':[('booking_date','=',False)]}"/>
                        </group>
                    </group>
                </xpath>


            </field>
        </record>


        <record id="mp_wk_booking_plan_form_view" model="ir.ui.view">
            <field name="name">Marketplace Booking Plan Form</field>
            <field name="model">booking.plan</field>
            <field name="type">form</field>
            <field name="arch" type="xml">

            <form string="Booking Plans">
                    <header>
                        <button name="button_set_pending_plan" type="object" class="btn-primary" icon="fa-paper-plane" string=" Request to Approve" invisible="not (context.get('mp_new_booking'))" attrs="{'invisible': ['|',('state','in',['pending','approved']),('marketplace_seller_id','=',False)] }"/>
                        <button name="button_approve_plan" type="object" class="btn-primary" icon="fa-check-circle" string=" Approve" invisible="not (context.get('mp_new_booking'))" attrs="{'invisible': ['|',('state','in',['approved','rejected','new']),('marketplace_seller_id','=',False)] }" groups="odoo_marketplace.marketplace_officer_group"/>
                        <button name="button_reject_plan" type="object" class="btn-primary" icon="fa-times-circle" string=" Reject" groups="odoo_marketplace.marketplace_officer_group" attrs="{'invisible': ['|',('state','in',['rejected','new']),('marketplace_seller_id','=',False)] }"/>
                        <field name="state" widget="statusbar"/>
                    </header>
                    <sheet>
                        <group>
                            <group>
                                <field name="name" attrs="{'readonly': [('state','not in',['new'])]}"/>
                                <field name="marketplace_seller_id" string="Requested By" attrs="{'readonly': ['|',('state','not in',['new']),('id','!=',False)]}" options="{'no_create_edit':True, 'no_open':True, 'no_quick_create':True}" groups="odoo_marketplace.marketplace_officer_group" domain="[('seller','=',True),('state','=','approved')]" required="1"/>
                            </group>
                            <group>
                                <field name="sequence" attrs="{'readonly': [('state','not in',['new'])]}"/>
                            </group>
                        </group>
                        <group>
                            <field name="discription" attrs="{'readonly': [('state','not in',['new'])]}"/>
                        </group>
                    </sheet>
                </form>


            </field>
        </record>


        <record id="mp_wk_booking_timeslot_tree_view" model="ir.ui.view">
            <field name="name">Marketplace Booking Time Slot Tree</field>
            <field name="model">booking.time.slot</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Booking Time Slots" editable="top" decoration-info="state=='new'" decoration-warning="state=='pending'" decoration-success="state=='approved'" decoration-danger="state=='rejected'">
                    <field name="sequence" widget="handle" groups="odoo_marketplace.marketplace_officer_group"/>
                    <field name="start_time" widget="float_time" attrs="{'readonly': [('state','not in',['new'])]}"/>
                    <field name="end_time" widget="float_time" attrs="{'readonly': [('state','not in',['new'])]}"/>
                    <field name="id" invisible="1"/>
                    <field name="marketplace_seller_id" string="Requested By" attrs="{'readonly': ['|',('state','not in',['new']),('id','!=',False)]}" options="{'no_create_edit':True, 'no_open':True, 'no_quick_create':True}" invisible="not (context.get('mp_new_booking') or context.get('mp_approved_booking'))" required="context.get('mp_new_booking') or context.get('mp_approved_booking')" groups="odoo_marketplace.marketplace_officer_group" domain="[('seller','=',True),('state','=','approved')]"/>
                    <field name="state" readonly="1" invisible="not (context.get('mp_new_booking') or context.get('mp_approved_booking'))"/>
                    <button name="button_set_pending_timeslot" type="object" aria-label="Request to Approve" class="text-primary btn-link fa fa-paper-plane" title="Request to Approve" invisible="not (context.get('mp_new_booking'))" attrs="{'invisible': [('state','in',['pending','approved'])]}"/>
                    <button name="button_approve_timeslot" type="object" aria-label="Click to Approve" class="text-success btn-link fa fa-check-circle" title="Click to Approve" invisible="not (context.get('mp_new_booking'))" attrs="{'invisible': [('state','in',['approved','rejected','new'])]}" groups="odoo_marketplace.marketplace_officer_group"/>
                    <button name="button_reject_timeslot" type="object" aria-label="Click to Reject" class="text-danger btn-link fa fa-times-circle" title="Click to Reject" invisible="not (context.get('mp_new_booking') or context.get('mp_approved_booking'))" groups="odoo_marketplace.marketplace_officer_group" attrs="{'invisible': ['|',('state','in',['rejected','new']),('marketplace_seller_id','=',False)]}"/>
                </tree>
            </field>
        </record>


        <record id="mp_wk_booking_plan_tree_view" model="ir.ui.view">
            <field name="name">wk.booking.plan.tree.mp.inherit</field>
            <field name="model">booking.plan</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
              <tree string="Booking Plans" decoration-info="state=='new'" decoration-warning="state=='pending'" decoration-success="state=='approved'" decoration-danger="state=='rejected'">
                    <field name="sequence" widget="handle" groups="odoo_marketplace.marketplace_officer_group"/>
                    <field name="name"/>
                    <field name="marketplace_seller_id" groups="odoo_marketplace.marketplace_officer_group"/>
                    <field name="state"/>
                </tree>

            </field>
        </record>



          <record id="mp_booking_timeslots_new_action" model="ir.actions.act_window">
            <field name="name">Marketplace Booking New TimeSlots</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">booking.time.slot</field>

            <field name="domain">[('state','in',['new','pending','rejected'])]</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{"mp_new_booking":1,}</field>

             <field
                name="view_ids"
                eval="[(5, 0, 0),
                    (0, 0, {'sequence': 1, 'view_mode': 'tree', 'view_id': ref('mp_wk_booking_timeslot_tree_view')}),

                ]"/>


        </record>

        <record id="mp_booking_timeslots_approved_action" model="ir.actions.act_window">
            <field name="name">Marketplace Booking Approved TimeSlots</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">booking.time.slot</field>

            <field name="domain">[('state','in',['approved'])]</field>
            <field name="view_mode">tree</field>
            <field name="context">{"mp_new_booking":1,}</field>

             <field
                name="view_ids"
                eval="[(5, 0, 0),
                    (0, 0, {'sequence': 1, 'view_mode': 'tree', 'view_id': ref('mp_wk_booking_timeslot_tree_view')}),

                ]"/>
        </record>


        <record id="mp_booking_plans_new_action" model="ir.actions.act_window">
            <field name="name">Marketplace Booking New plans</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">booking.plan</field>

            <field name="domain">[('state','in',['new','pending','rejected'])]</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{"mp_new_booking":1,}</field>

             <field
                name="view_ids"
                eval="[(5, 0, 0),
                    (0, 0, {'sequence': 1, 'view_mode': 'tree', 'view_id': ref('mp_wk_booking_plan_tree_view')}),
                    (0, 0, {'sequence': 1, 'view_mode': 'form', 'view_id': ref('mp_wk_booking_plan_form_view')}),

                ]"/>

        </record>

         <record id="mp_booking_plans_approved_action" model="ir.actions.act_window">
            <field name="name">	Marketplace Booking Approved plans</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">booking.plan</field>

            <field name="domain">[('state','in',['approved'])]</field>
            <field name="view_mode">tree</field>
            <field name="context">{"mp_new_booking":1,}</field>

              <field
                name="view_ids"
                eval="[(5, 0, 0),
                    (0, 0, {'sequence': 1, 'view_mode': 'tree', 'view_id': ref('mp_wk_booking_plan_tree_view')}),
                    (0, 0, {'sequence': 1, 'view_mode': 'form', 'view_id': ref('mp_wk_booking_plan_form_view')}),

                ]"/>

        </record>




          <menuitem
            name= "Booking &amp; Reservation"
            id= "mp_booking_main_menu"
            sequence= "7"
            parent= "odoo_marketplace.wk_seller_dashboard"
            groups="odoo_marketplace.marketplace_seller_group"
        />


         <menuitem
            name= "Time Slots"
            id= "mp_booking_timeslots_main_menu"
            sequence= "1"
            parent= "mp_booking_main_menu"
            groups="odoo_marketplace.marketplace_seller_group"
        />
         <menuitem
            name= "Plans"
            id= "mp_booking_plans_main_menu"
            sequence= "2"
            parent= "mp_booking_main_menu"
            groups="odoo_marketplace.marketplace_seller_group"
        />

         <menuitem
            name= "Non-Approved"
            id= "mp_booking_timeslots_new_menu"
            action="mp_booking_timeslots_new_action"
            sequence= "1"
            parent= "mp_booking_timeslots_main_menu"
            groups="odoo_marketplace.marketplace_seller_group"
        />
        <menuitem
            name= "Approved"
            id= "mp_booking_timeslots_approved_menu"
            sequence= "2"
            action="mp_booking_timeslots_approved_action"
            parent= "mp_booking_timeslots_main_menu"
            groups="odoo_marketplace.marketplace_seller_group"
        />







        <menuitem
            name= "Non-Approved"
            id= "mp_booking_plans_new_menu"
            sequence= "1"
            parent= "mp_booking_plans_main_menu"
            action="mp_booking_plans_new_action"
            groups="odoo_marketplace.marketplace_seller_group"
        />
        <menuitem
            name= "Approved"
            id= "mp_booking_plans_approved_menu"
            sequence= "2"
            action="mp_booking_plans_approved_action"
            parent= "mp_booking_plans_main_menu"
            groups="odoo_marketplace.marketplace_seller_group"
        />




















    </data>
</odoo>